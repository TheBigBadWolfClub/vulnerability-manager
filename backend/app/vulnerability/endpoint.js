const vulnerabilityService = require('./service');
const express = require("express");

const vulnerabilityRoutes = express.Router();
vulnerabilityRoutes.get('/vulnerabilities', list);
module.exports = vulnerabilityRoutes

async function list(req, res, next) {
    try {
        const entities = await vulnerabilityService.list()
        const restModel = entities.map(v => {
            return {
                title: v.title,
                state: v.state,
                cvss: v.cvss,
                cvssScores: v.cvssScores,
            }
        })
        res.status(200).send(restModel).end();
    } catch (error) {
        next(error)
    }
}


