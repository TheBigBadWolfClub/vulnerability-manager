const mongoose = require('mongoose');
const Schema = mongoose.Schema;

const SeverityType = ['NONE', 'LOW', 'MEDIUM', 'HIGH', 'CRITICAL'];
const CvssScoresSchema = new Schema({
    schema_version: {
        type: Number,
        default: 0
    },
    baseScore: {
        type: Number,
        min: 0,
        max: 10,
        default: 0
    },
    baseSeverity: {
        type: String,
        enum: SeverityType,
        default: 'NONE'
    },
    baseISS: {
        type: Number,
        default: 0
    },
    baseImpact: {
        type: Number,
        default: 0
    },
    baseExploitability: {
        type: Number,
        default: 0
    },
    temporalScore: {
        type: Number,
        min: 0,
        max: 10,
        default: 0
    },
    temporalSeverity: {
        type: String,
        enum: SeverityType,
        default: 'NONE'
    },
    environmentalScore: {
        type: Number,
        min: 0,
        max: 10,
        default: 0
    },
    environmentalSeverity: {
        type: String,
        enum: SeverityType,
        default: 'NONE'
    },
    environmentalMISS: {
        type: Number,
        default: 0
    },
    environmentalModifiedImpact: {
        type: Number,
        default: 0
    },
    environmentalModifiedExploitability: {
        type: Number,
        default: 0
    },
    vectorString: {
        type: String,
        default: ''
    },
    cvss: {
        type: Schema.Types.ObjectId,
        ref: 'CVSS',
    },
    vulnerability: {
        type: Schema.Types.ObjectId,
        ref: 'Vulnerability',
    },
}, {timestamps: true})

module.exports = mongoose.model('CvssScores', CvssScoresSchema);
