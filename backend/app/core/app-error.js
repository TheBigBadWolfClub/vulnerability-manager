const {STATUS_CODES} = require("http");


class AppError {

    _type = 'ERROR';

    get type() {
        return this._type;
    }

    _code = 500;

    get code() {
        return this._code || 500;
    }

    set code(value) {
        this._code = value;
    }

    _message = '';

    get message() {
        return this._message || STATUS_CODES[this.code];
    }

    set message(value) {
        this._message = value;
    }

    _errorObj = '';

    get errorObj() {
        return this._errorObj;
    }

    set errorObj(value) {
        this._errorObj = value;
    }

    _stack = '';

    get stack() {
        return this._stack;
    }

    set stack(value) {
        this._stack = value;
    }

    getClientObject() {
        return {
            type: this.type,
            code: this.code,
            message: this.message,
            errorObj: this.errorObj,
        };
    }

    toGraphQL() {
        return new Error(`${this.code} ${this.message}`);
    }
}

const buildError = (code, message, errorObj, stack) => {
    const apiError = new AppError();
    apiError.code = code
    apiError.message = message
    apiError.errorObj = errorObj
    apiError.stack = stack
    return apiError
}

const AUTH_REQUIRED_ERROR = new Error(`403 ${STATUS_CODES[403]}`);

module.exports = {ApiError: AppError, buildError, AUTH_REQUIRED_ERROR}
