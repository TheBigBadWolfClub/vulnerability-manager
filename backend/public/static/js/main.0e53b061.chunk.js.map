{"version":3,"sources":["graphql/ApiService.js","context/LoginContext.js","context/SnackBarContext.js","pages/Login.js","graphql/Cvss.js","graphql/vulnerability.js","components/charts/ChartStates.js","components/charts/ChartOverdueStates.js","components/charts/AttackVector.js","components/charts/ExploitCodeMaturity.js","components/charts/ScoresTemDistribution.js","components/charts/ScoresBaseDistribution.js","components/charts/ScoresEnvDistribution.js","components/charts/SeverityBase.js","components/charts/SeverityEnvironmental.js","components/charts/SeverityTemporal.js","pages/Cvss.js","pages/Vulnerabilities.js","components/navigation/MainNavigation.js","pages/CreateVulnerability.js","components/view-vulnerability/CustomDivider.js","components/view-vulnerability/ViewArrayField.js","components/view-vulnerability/ViewGenericScoresBar.js","components/view-vulnerability/GenericEdit.js","components/view-vulnerability/ViewCvssSection.js","components/view-vulnerability/ViewCvss.js","components/view-vulnerability/ViewScores.js","components/view-vulnerability/ViewVulnerability.js","components/support/SnackBar.js","App.js","index.js"],"names":["module","exports","fetchWrapper","jqlQuery","auth","JSON","parse","localStorage","getItem","header","Authorization","token","fetch","window","location","protocol","hostname","port","method","body","stringify","headers","then","res","status","Error","statusText","json","resData","errors","length","message","myReducer","state","action","type","setItem","authData","clear","jsonToken","LoginCtx","React","createContext","LoginCtxProvider","props","useReducer","authState","dispatchAuth","Provider","value","children","msg","open","initialState","SnackBarCtx","SnackBarCtxProvider","dispatch","LoginPage","useContext","usernameEl","createRef","passwordEl","useState","isLogin","className","onSubmit","event","preventDefault","username","current","password","trim","requestBody","query","loginData","data","login","catch","err","console","log","htmlFor","id","ref","cvssFields","cvssScoresFields","queryTypes","tableQuery","chartState","getVulnerabilityFn","getSimplifiedVulnerability","field","ChartStates","chartData","setChartData","useEffect","counter","vulnerabilities","reduce","r","row","Fragment","Paper","elevation","width","height","barGap","margin","top","right","left","bottom","strokeDasharray","dataKey","fill","ChartOverdueStates","acc","cur","dueDate","Date","now","chartStats","Object","keys","map","key","endsWith","replace","name","assign","barCategoryGap","AttackVector","result","v","cvss","attackVector","k","count","cx","cy","outerRadius","tick","fontSize","stroke","fillOpacity","ExploitCodeMaturity","exploitCodeMaturity","ScoresTemDistribution","cvssScores","Math","round","temporalScore","ScoresBaseDistribution","baseScore","ScoresEnvDistribution","environmentalScore","SeverityBase","baseSeverity","SeverityEnvironmental","environmentalSeverity","SeverityTemporal","temporalSeverity","CvssPage","Vulnerabilities","history","useHistory","tableData","setTableData","title","columns","options","search","paging","filtering","exportButton","isLoading","actions","push","icon","tooltip","onClick","rowData","pathname","_id","bodyRequest","deleteVulnerability","deleteHandler","getActions","MainNavigation","to","CreateVulnerability","cveId","setCveId","setTitle","description","setDescription","vState","setVState","selectedDate","setSelectedDate","createVulnerability","TextField","label","placeholder","onChange","e","target","required","InputLabelProps","shrink","InputLabel","Select","labelId","defaultValue","MenuItem","time","getTime","TextareaAutosize","rows","useStyles","makeStyles","theme","divider","backgroundColor","CustomDivider","classes","Divider","ViewArrayField","vulnerabilityId","fieldArrayId","editMode","arrayData","setArrayData","newItemRef","vulnerability","getVulnerability","removeElem","index","prevState","splice","elem","IconButton","color","aria-label","component","Button","variant","size","arrBuilder","ele","join","addArrayEntry","ViewGenericScoresBar","scores","scoresData","getStyle","sev","viewColor","marginLeft","Chip","style","noIcon","display","GenericEdit","setData","onChangeFn","prev","InputProps","readOnly","disableUnderline","input","Input","dateObj","parseInt","day","getDate","month","getMonth","getFullYear","getFormattedDate","inputProps","rowsMin","updateVulnerability","ViewCvssSection","idSection","fieldsArray","cvssData","scoreValue","scoreSeverity","helper","handleChange","getEnumValues","filter","item","getEnumOptions","enumValues","getLabel","itemId","toUpperCase","slice","enumOp","dense","ViewCvss","setCvssData","setScoresData","setHelper","types","__type","inputFields","clone","inputBuilder","entries","i","updateCvss","ViewScores","group","addSection","startsWith","TabPanel","other","role","hidden","aria-labelledby","Box","p","Typography","root","flexGrow","ViewVulnerability","match","params","isEdit","setIsEdit","setValue","FormControlLabel","control","Switch","checked","Tabs","newValue","indicatorColor","textColor","centered","Tab","SnackBar","closeSnackBar","reason","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","onClose","Close","App","from","exact","path","VulnerabilitiesPage","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.0e53b061.chunk.js","sourcesContent":["module.exports = {\r\n  fetchWrapper: (jqlQuery) => {\r\n    const auth = JSON.parse(localStorage.getItem('authData'));\r\n    const token = auth ? auth.token : 'badToken'\r\n    const header = {\r\n      'Content-Type': 'application/json',\r\n      Authorization: 'Bearer ' + token\r\n    }\r\n    return fetch(`${window.location.protocol}//${window.location.hostname}:${window.location.port}/graphql`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(jqlQuery),\r\n      headers: header\r\n    }).then(res => {\r\n      if (res.status !== 200 && res.status !== 201) {\r\n        throw new Error(`Failed: statusCode[${res.status}] text[${res.statusText}]`);\r\n      }\r\n      return res.json();\r\n    })\r\n      .then(resData => {\r\n        if (resData.errors && resData.errors.length > 0) {\r\n          throw new Error(`Error: ${resData.errors[0].message}`)\r\n        }\r\n        return resData;\r\n      })\r\n  }\r\n}\r\n\r\n\r\n","import React from 'react'\r\n\r\nlet myReducer = (state, action) => {\r\n  switch (action.type) {\r\n    case \"LOGIN\":\r\n      localStorage.setItem(\"authData\", JSON.stringify(action.authData));\r\n      return { ...state,  ...action.authData};\r\n    case \"LOGOUT\":\r\n      localStorage.clear();\r\n      return { ...{}};\r\n    default:\r\n      return;\r\n  }\r\n};\r\n\r\nconst jsonToken = JSON.parse(localStorage.getItem('authData')) || {};\r\nconst LoginCtx = React.createContext(jsonToken);\r\nfunction LoginCtxProvider(props) {\r\n  const [authState, dispatchAuth] = React.useReducer(myReducer, jsonToken);\r\n  return (\r\n    <LoginCtx.Provider value={{ authState, dispatchAuth }}>\r\n      {props.children}\r\n    </LoginCtx.Provider>\r\n  );\r\n}\r\nexport { LoginCtx, LoginCtxProvider };\r\n","import React from 'react'\r\n\r\nlet myReducer = (state, action) => {\r\n  switch (action.type) {\r\n    case \"OPEN\":\r\n      return { ...state, msg: action.msg, open: true };\r\n    case \"CLOSE\":\r\n      return { ...state, msg: '', open: false };\r\n    default:\r\n      return;\r\n  }\r\n};\r\nconst initialState = { message: '', open: false }\r\nconst SnackBarCtx = React.createContext(initialState);\r\nfunction SnackBarCtxProvider(props) {\r\n  const [state, dispatch] = React.useReducer(myReducer, initialState);\r\n  return (\r\n    <SnackBarCtx.Provider value={{ state, dispatch }}>\r\n      {props.children}\r\n    </SnackBarCtx.Provider>\r\n  );\r\n}\r\nexport { SnackBarCtx, SnackBarCtxProvider };\r\n","import React from 'react';\r\n\r\nimport './Login.css';\r\nimport {LoginCtx} from '../context/LoginContext'\r\nimport {fetchWrapper} from \"../graphql/ApiService\";\r\nimport {SnackBarCtx} from \"../context/SnackBarContext\";\r\n\r\nexport default function LoginPage(props) {\r\n  const {authState, dispatchAuth} = React.useContext(LoginCtx);\r\n  const {state, dispatch} = React.useContext(SnackBarCtx);\r\n  let usernameEl = React.createRef();\r\n  let passwordEl = React.createRef();\r\n\r\n  const [isLogin, setIsLogin] =   React.useState(true);\r\n\r\n\r\n  const switchModeHandler = () => {\r\n    this.setState(prevState => {\r\n      return {isLogin: !prevState.isLogin};\r\n    });\r\n  };\r\n\r\n  const submitHandler = event => {\r\n    event.preventDefault();\r\n    const username = usernameEl.current.value;\r\n    const password = passwordEl.current.value;\r\n\r\n    if (username.trim().length === 0 || password.trim().length === 0) {\r\n      return;\r\n    }\r\n\r\n    let requestBody = {\r\n      query: `\r\n        query {\r\n          login(username: \"${username}\", password: \"${password}\") {\r\n            userId\r\n            token\r\n            tokenExpiration\r\n            role\r\n          }\r\n        }\r\n      `\r\n    };\r\n\r\n    if (!isLogin) {\r\n      requestBody = {\r\n        query: `\r\n          mutation {\r\n            createUser(userInput: {username: \"${username}\", password: \"${password}\"}) {\r\n              _id\r\n              email\r\n              role\r\n            }\r\n          }\r\n        `\r\n      };\r\n    }\r\n\r\n    fetchWrapper(requestBody)\r\n      .then(resData => {\r\n        const loginData = resData.data.login\r\n        if (loginData.token) {\r\n          dispatchAuth({ type: \"LOGIN\", authData: loginData })\r\n        }\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n  };\r\n\r\n\r\n  return (\r\n    <form className=\"auth-form\" onSubmit={submitHandler}>\r\n      <div className=\"form-control\">\r\n        <label htmlFor=\"username\">Username</label>\r\n        <input type=\"input\" id=\"username\" ref={usernameEl}/>\r\n      </div>\r\n      <div className=\"form-control\">\r\n        <label htmlFor=\"password\">Password</label>\r\n        <input type=\"password\" id=\"password\" ref={passwordEl}/>\r\n      </div>\r\n      <div className=\"form-actions\">\r\n        <button type=\"submit\">Submit</button>\r\n        {/*<button type=\"button\" onClick={this.switchModeHandler}>*/}\r\n        {/*    Switch to {this.state.isLogin ? 'Signup' : 'Login'}*/}\r\n        {/*</button>*/}\r\n      </div>\r\n    </form>\r\n  );\r\n\r\n}\r\n","const cvssFields =  `cvss {\r\n      _id\r\n      attackVector\r\n      attackComplexity\r\n      privilegesRequired\r\n      userInteraction\r\n      scope\r\n      confidentialityImpact\r\n      integrityImpact\r\n      availabilityImpact\r\n      exploitCodeMaturity\r\n      remediationLevel\r\n      reportConfidence\r\n      confidentialityRequirement\r\n      integrityRequirement\r\n      availabilityRequirement\r\n      modifiedAttackVector\r\n      modifiedAttackComplexity\r\n      modifiedPrivilegesRequired\r\n      modifiedUserInteraction\r\n      modifiedScope\r\n      modifiedConfidentialityImpact\r\n      modifiedIntegrityImpact\r\n      modifiedAvailabilityImpact\r\n    }`\r\n\r\n\r\nconst cvssScoresFields =  `cvssScores {\r\n            _id\r\n            baseScore\r\n            baseSeverity\r\n            baseISS\r\n            baseImpact\r\n            baseExploitability\r\n            temporalScore\r\n            temporalSeverity\r\n            environmentalScore\r\n            environmentalSeverity\r\n            environmentalMISS\r\n            environmentalModifiedImpact\r\n            environmentalModifiedExploitability\r\n          }\r\n  `\r\n\r\nconst queryTypes = {\r\n  query: `\r\n     query getTypes {\r\n        __type(name: \"CVSSInput\") {\r\n          name\r\n          inputFields{\r\n            name \r\n            type{\r\n              kind\r\n              name\r\n              description\r\n              enumValues{\r\n                name \r\n                description\r\n              }\r\n            }\r\n          }\r\n        }\r\n     }\r\n  `\r\n}\r\n\r\nconst mutationQuery = (id, data) => {\r\n  return {\r\n    query: `\r\n      mutation {\r\n        updateCvss(id: \"${id}\", input: ${data}) {\r\n          ${cvssFields}\r\n          ${cvssScoresFields}\r\n        }\r\n      }\r\n      `\r\n  }\r\n}\r\n\r\n\r\nexport {queryTypes, cvssFields, cvssScoresFields, mutationQuery}\r\n","import {cvssFields, cvssScoresFields} from './Cvss'\r\n\r\n\r\nconst tableQuery = {\r\n  query: `\r\n          query {\r\n            vulnerabilities {\r\n              _id\r\n              cveId\r\n              title\r\n              cvss {\r\n                attackVector\r\n                attackComplexity\r\n              }\r\n              cvssScores {\r\n                baseSeverity\r\n                temporalSeverity\r\n                environmentalSeverity\r\n              }\r\n            }\r\n          }\r\n      `\r\n}\r\n\r\nconst chartState = {\r\n  query: `\r\n          query {\r\n            vulnerabilities {\r\n              state\r\n              dueDate\r\n              cvss {\r\n                attackVector\r\n                exploitCodeMaturity\r\n              }\r\n              cvssScores {\r\n                baseScore\r\n                baseSeverity\r\n                temporalScore\r\n                temporalSeverity\r\n                environmentalScore\r\n                environmentalSeverity\r\n              }\r\n            }\r\n          }\r\n      `\r\n}\r\n\r\nconst createVulnerability = (cveId, title, description, state, dueDate) => {\r\n  return {\r\n    query: `\r\n      mutation {\r\n        createVulnerability(input: {\r\n          cveId:\"${cveId}\", \r\n          title:\"${title}\", \r\n          description:\"${description}\", \r\n          state:${state}, \r\n          dueDate:\"${dueDate}\"}) {\r\n            _id\r\n         }\r\n      }\r\n    `\r\n  }\r\n}\r\n\r\nconst updateVulnerability = (data) => {\r\n  return {\r\n    query: `\r\n     mutation {\r\n     updateVulnerability(input: {\r\n        id: \"${data._id}\",\r\n        title: \"${data.title}\",\r\n        description: \"${data.description}\",\r\n        dueDate:\"${data.dueDate}\",\r\n        state: ${data.state}}) {\r\n          title\r\n          description\r\n          dueDate\r\n          state\r\n        }}\r\n      `\r\n  }\r\n}\r\n\r\nconst getVulnerabilityFn = (id) => {\r\n  return {\r\n    query: `\r\n     query {\r\n      getVulnerability(id: \"${id}\") {\r\n          _id\r\n          cveId\r\n          title\r\n          description\r\n          evidence\r\n          prevention\r\n          ${cvssFields}\r\n          ${cvssScoresFields}\r\n          createdAt\r\n          updatedAt\r\n        }\r\n     }\r\n  `\r\n  }\r\n}\r\n\r\nconst getSimplifiedVulnerability = (id, field) => {\r\n  return {\r\n    query: `\r\n     query {\r\n      getVulnerability(id: \"${id}\") {\r\n          _id\r\n          ${field}\r\n        }\r\n     }\r\n  `\r\n  }\r\n}\r\n\r\nconst deleteVulnerability = (id) => {\r\n  return {\r\n    query: `\r\n     mutation {\r\n       deleteVulnerability(id:\"${id}\") {\r\n          _id\r\n          cveId\r\n          title\r\n          cvss {\r\n            attackVector\r\n            attackComplexity\r\n          }\r\n          cvssScores {\r\n            baseSeverity\r\n            temporalSeverity\r\n            environmentalSeverity\r\n          }\r\n       }\r\n     }\r\n  `\r\n  }\r\n}\r\n\r\nexport {\r\n  tableQuery,\r\n  getVulnerabilityFn,\r\n  getSimplifiedVulnerability,\r\n  deleteVulnerability,\r\n  createVulnerability,\r\n  updateVulnerability,\r\n  chartState\r\n}\r\n","import React from \"react\";\r\nimport BarChart from \"recharts/lib/chart/BarChart\";\r\nimport CartesianGrid from \"recharts/lib/cartesian/CartesianGrid\";\r\nimport XAxis from \"recharts/lib/cartesian/XAxis\";\r\nimport YAxis from \"recharts/lib/cartesian/YAxis\";\r\nimport Tooltip from \"recharts/lib/component/Tooltip\";\r\nimport Legend from \"recharts/lib/component/Legend\";\r\nimport Bar from \"recharts/lib/cartesian/Bar\";\r\nimport {fetchWrapper} from \"../../graphql/ApiService\";\r\nimport {chartState} from \"../../graphql/vulnerability\";\r\nimport {SnackBarCtx} from \"../../context/SnackBarContext\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\n\r\nimport './ChartStates.css'\r\nexport default function ChartStates(props) {\r\n\r\n  const [chartData, setChartData] = React.useState([]);\r\n  const {state, dispatch} = React.useContext(SnackBarCtx);\r\n\r\n  React.useEffect(() => {\r\n    fetchWrapper(chartState)\r\n      .then(resData => {\r\n        const serverData = resData.data.vulnerabilities;\r\n        const counter = serverData.reduce((r, row) => {\r\n          r[row.state] = ++r[row.state] || 1;\r\n          return r;\r\n        }, {});\r\n        setChartData([counter])\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Paper elevation={2} className={'chart-paper'}>\r\n        <label className={'chart-label'}>Vulnerabilities States</label>\r\n        <BarChart\r\n          width={500}\r\n          height={300}\r\n          data={chartData}\r\n          barGap={30}\r\n          margin={{\r\n            top: 5, right: 30, left: 20, bottom: 5,\r\n          }}\r\n        >\r\n          <CartesianGrid strokeDasharray=\"3 3\"/>\r\n          <XAxis dataKey=\"name\"/>\r\n          <YAxis/>\r\n          <Tooltip/>\r\n          <Legend/>\r\n          <Bar dataKey=\"OPEN\" fill=\"red\"  />\r\n          <Bar dataKey=\"PENDING\" fill=\"orange\"/>\r\n          <Bar dataKey=\"TESTING\" fill=\"yellow\"/>\r\n          <Bar dataKey=\"REVIEW\" fill=\"greenyellow\"/>\r\n          <Bar dataKey=\"FIXED\" fill=\"green\"/>\r\n        </BarChart>\r\n      </Paper>\r\n    </React.Fragment>\r\n  )\r\n\r\n}\r\n","import React from \"react\";\r\nimport BarChart from \"recharts/lib/chart/BarChart\";\r\nimport CartesianGrid from \"recharts/lib/cartesian/CartesianGrid\";\r\nimport XAxis from \"recharts/lib/cartesian/XAxis\";\r\nimport YAxis from \"recharts/lib/cartesian/YAxis\";\r\nimport Tooltip from \"recharts/lib/component/Tooltip\";\r\nimport Legend from \"recharts/lib/component/Legend\";\r\nimport Bar from \"recharts/lib/cartesian/Bar\";\r\nimport {fetchWrapper} from \"../../graphql/ApiService\";\r\nimport {chartState} from \"../../graphql/vulnerability\";\r\nimport {SnackBarCtx} from \"../../context/SnackBarContext\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\n\r\nimport './ChartStates.css'\r\n\r\nexport default function ChartOverdueStates(props) {\r\n\r\n  const [chartData, setChartData] = React.useState([]);\r\n  const {state, dispatch} = React.useContext(SnackBarCtx);\r\n\r\n\r\n  React.useEffect(() => {\r\n    fetchWrapper(chartState)\r\n      .then(resData => {\r\n        const serverData = resData.data.vulnerabilities;\r\n        const counter = serverData\r\n          .reduce((acc, cur) => {\r\n          if (cur.dueDate < Date.now()) {\r\n            acc[cur.state + '-due'] = ++acc[cur.state + '-due'] || 1;\r\n          } else {\r\n            acc[cur.state] = ++acc[cur.state] || 1;\r\n          }\r\n          return acc;\r\n        }, {});\r\n\r\n        const chartStats = [{},{}]\r\n        Object.keys(counter).map( (key) => {\r\n          if(key.endsWith('-due')) {\r\n            const field = key.replace('-due', '')\r\n            return {name: 'Overdue', [field]: counter[key]}\r\n          }\r\n          return {name: 'OnTime', [key]: counter[key]}\r\n        }).map(r => {\r\n          if(r.name === 'Overdue') return Object.assign(chartStats[0], r)\r\n          if(r.name === 'OnTime') return Object.assign(chartStats[1], r)\r\n        });\r\n\r\n        setChartData(chartStats)\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Paper elevation={2} className={'chart-paper'}>\r\n        <label className={'chart-label'}>Overdue status</label>\r\n        <BarChart\r\n          width={500}\r\n          height={300}\r\n          data={chartData}\r\n          barCategoryGap={50}\r\n          barGap={10}\r\n          margin={{\r\n            top: 5, right: 30, left: 20, bottom: 5,\r\n          }}\r\n        >\r\n          <CartesianGrid strokeDasharray=\"3 3\"/>\r\n          <XAxis dataKey=\"name\"/>\r\n          <YAxis/>\r\n          <Tooltip/>\r\n          <Legend/>\r\n          <Bar dataKey=\"OPEN\" fill=\"red\"/>\r\n          <Bar dataKey=\"PENDING\" fill=\"orange\"/>\r\n          <Bar dataKey=\"TESTING\" fill=\"yellow\"/>\r\n          <Bar dataKey=\"REVIEW\" fill=\"greenyellow\"/>\r\n          <Bar dataKey=\"FIXED\" fill=\"green\"/>\r\n        </BarChart>\r\n      </Paper>\r\n    </React.Fragment>\r\n  )\r\n\r\n}\r\n","import React from \"react\";\r\nimport BarChart from \"recharts/lib/chart/BarChart\";\r\nimport CartesianGrid from \"recharts/lib/cartesian/CartesianGrid\";\r\nimport XAxis from \"recharts/lib/cartesian/XAxis\";\r\nimport YAxis from \"recharts/lib/cartesian/YAxis\";\r\nimport Tooltip from \"recharts/lib/component/Tooltip\";\r\nimport Legend from \"recharts/lib/component/Legend\";\r\nimport Bar from \"recharts/lib/cartesian/Bar\";\r\nimport {fetchWrapper} from \"../../graphql/ApiService\";\r\nimport {chartState} from \"../../graphql/vulnerability\";\r\nimport {SnackBarCtx} from \"../../context/SnackBarContext\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\n\r\nimport './ChartStates.css'\r\nimport RadarChart from \"recharts/lib/chart/RadarChart\";\r\nimport PolarGrid from \"recharts/lib/polar/PolarGrid\";\r\nimport PolarAngleAxis from \"recharts/lib/polar/PolarAngleAxis\";\r\nimport PolarRadiusAxis from \"recharts/lib/polar/PolarRadiusAxis\";\r\nimport Radar from \"recharts/lib/polar/Radar\";\r\n\r\nexport default function AttackVector(props) {\r\n\r\n  const [chartData, setChartData] = React.useState([]);\r\n  const {state, dispatch} = React.useContext(SnackBarCtx);\r\n  React.useEffect(() => {\r\n    fetchWrapper(chartState)\r\n      .then(resData => {\r\n        const serverData = resData.data.vulnerabilities;\r\n        const result = serverData\r\n          .map(v => v.cvss)\r\n          .reduce((r, row) => {\r\n            r[row.attackVector] = ++r[row.attackVector] || 1;\r\n            return r;\r\n          }, {});\r\n\r\n        const counter = ['NETWORK', 'ADJACENT_NETWORK', 'LOCAL', 'PHYSICAL'].map(k => {\r\n          return {type: k, count: result[k]};\r\n        });\r\n\r\n        setChartData(counter)\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Paper elevation={2} className={'chart-paper'}>\r\n        <label className={'chart-label'}>Attack Vector</label>\r\n        <RadarChart cx={250} cy={200} outerRadius={100} width={500} height={400} data={chartData}>\r\n          <PolarGrid/>\r\n          <PolarAngleAxis dataKey=\"type\" tick={{fontSize: 10}}/>\r\n          <PolarRadiusAxis/>\r\n          <Radar name=\"AttackVector\" dataKey=\"count\" stroke=\"#8884d8\" fill=\"#8884d8\" fillOpacity={0.6}/>\r\n          <Tooltip/>\r\n        </RadarChart>\r\n      </Paper>\r\n    </React.Fragment>\r\n  )\r\n\r\n}\r\n","import React from \"react\";\r\nimport {fetchWrapper} from \"../../graphql/ApiService\";\r\nimport {chartState} from \"../../graphql/vulnerability\";\r\nimport {SnackBarCtx} from \"../../context/SnackBarContext\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\n\r\nimport './ChartStates.css'\r\nimport RadarChart from \"recharts/lib/chart/RadarChart\";\r\nimport PolarGrid from \"recharts/lib/polar/PolarGrid\";\r\nimport PolarAngleAxis from \"recharts/lib/polar/PolarAngleAxis\";\r\nimport PolarRadiusAxis from \"recharts/lib/polar/PolarRadiusAxis\";\r\nimport Radar from \"recharts/lib/polar/Radar\";\r\nimport Tooltip from \"recharts/lib/component/Tooltip\";\r\n\r\nexport default function ExploitCodeMaturity(props) {\r\n\r\n  const [chartData, setChartData] = React.useState([]);\r\n  const {state, dispatch} = React.useContext(SnackBarCtx);\r\n  React.useEffect(() => {\r\n    fetchWrapper(chartState)\r\n      .then(resData => {\r\n        const serverData = resData.data.vulnerabilities;\r\n        const result = serverData\r\n          .map(v => v.cvss)\r\n          .reduce((r, row) => {\r\n            r[row.exploitCodeMaturity] = ++r[row.exploitCodeMaturity] || 1;\r\n            return r;\r\n          }, {});\r\n\r\n        const counter = ['UNPROVEN', 'PROOF_OF_CONCEPT', 'FUNCTIONAL', 'HIGH', 'NOT_DEFINED'].map(k => {\r\n          return {type: k, count: result[k]};\r\n        });\r\n\r\n        setChartData(counter)\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Paper elevation={2} className={'chart-paper'}>\r\n        <label className={'chart-label'}>Exploit Code Maturity</label>\r\n        <RadarChart cx={250} cy={200} outerRadius={100} width={500} height={400} data={chartData}>\r\n          <PolarGrid/>\r\n          <PolarAngleAxis dataKey=\"type\" tick={{fontSize: 10}}/>\r\n          <PolarRadiusAxis/>\r\n          <Radar name=\"exploitCodeMaturity\" dataKey=\"count\" stroke=\"#8884d8\" fill=\"#8884d8\" fillOpacity={0.6}/>\r\n          <Tooltip/>\r\n        </RadarChart>\r\n      </Paper>\r\n    </React.Fragment>\r\n  )\r\n\r\n}\r\n","import React from \"react\";\r\nimport BarChart from \"recharts/lib/chart/BarChart\";\r\nimport CartesianGrid from \"recharts/lib/cartesian/CartesianGrid\";\r\nimport XAxis from \"recharts/lib/cartesian/XAxis\";\r\nimport YAxis from \"recharts/lib/cartesian/YAxis\";\r\nimport Tooltip from \"recharts/lib/component/Tooltip\";\r\nimport Legend from \"recharts/lib/component/Legend\";\r\nimport Bar from \"recharts/lib/cartesian/Bar\";\r\nimport {fetchWrapper} from \"../../graphql/ApiService\";\r\nimport {chartState} from \"../../graphql/vulnerability\";\r\nimport {SnackBarCtx} from \"../../context/SnackBarContext\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\n\r\nimport './ChartStates.css'\r\n\r\nexport default function ScoresTemDistribution(props) {\r\n\r\n  const [chartData, setChartData] = React.useState([]);\r\n  const {state, dispatch} = React.useContext(SnackBarCtx);\r\n\r\n  React.useEffect(() => {\r\n    fetchWrapper(chartState)\r\n      .then(resData => {\r\n        const serverData = resData.data.vulnerabilities;\r\n        const counter = serverData\r\n          .map(v => v.cvssScores)\r\n          .reduce((r, row) => {\r\n            r[Math.round(row.temporalScore)] = ++r[Math.round(row.temporalScore)] || 1;\r\n            return r;\r\n          }, {});\r\n\r\n        setChartData([counter])\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Paper elevation={2} className={'chart-paper'}>\r\n        <label className={'chart-label'}>Temporal Score Distribution</label>\r\n        <BarChart\r\n          width={500}\r\n          height={300}\r\n          data={chartData}\r\n          barGap={20}\r\n          margin={{\r\n            top: 5, right: 30, left: 20, bottom: 5,\r\n          }}\r\n        >\r\n          <CartesianGrid strokeDasharray=\"3 3\"/>\r\n          <XAxis dataKey=\"name\"/>\r\n          <YAxis/>\r\n          <Tooltip/>\r\n          <Legend/>\r\n          <Bar dataKey=\"0\" fill=\"green\"/>\r\n          <Bar dataKey=\"1\" fill=\"forestgreen\"/>\r\n          <Bar dataKey=\"2\" fill=\"greenyellow\"/>\r\n          <Bar dataKey=\"3\" fill=\"yellowgreen\"/>\r\n          <Bar dataKey=\"4\" fill=\"yellow\"/>\r\n          <Bar dataKey=\"5\" fill=\"coral\"/>\r\n          <Bar dataKey=\"6\" fill=\"orange\"/>\r\n          <Bar dataKey=\"7\" fill=\"darkorange\"/>\r\n          <Bar dataKey=\"8\" fill=\"orangered\"/>\r\n          <Bar dataKey=\"9\" fill=\"red\"/>\r\n          <Bar dataKey=\"10\" fill=\"darkred\"/>\r\n        </BarChart>\r\n      </Paper>\r\n    </React.Fragment>\r\n  )\r\n\r\n}\r\n","import React from \"react\";\r\nimport BarChart from \"recharts/lib/chart/BarChart\";\r\nimport CartesianGrid from \"recharts/lib/cartesian/CartesianGrid\";\r\nimport XAxis from \"recharts/lib/cartesian/XAxis\";\r\nimport YAxis from \"recharts/lib/cartesian/YAxis\";\r\nimport Tooltip from \"recharts/lib/component/Tooltip\";\r\nimport Legend from \"recharts/lib/component/Legend\";\r\nimport Bar from \"recharts/lib/cartesian/Bar\";\r\nimport {fetchWrapper} from \"../../graphql/ApiService\";\r\nimport {chartState} from \"../../graphql/vulnerability\";\r\nimport {SnackBarCtx} from \"../../context/SnackBarContext\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\n\r\nimport './ChartStates.css'\r\n\r\nexport default function ScoresBaseDistribution(props) {\r\n\r\n  const [chartData, setChartData] = React.useState([]);\r\n  const {state, dispatch} = React.useContext(SnackBarCtx);\r\n\r\n  React.useEffect(() => {\r\n    fetchWrapper(chartState)\r\n      .then(resData => {\r\n        const serverData = resData.data.vulnerabilities;\r\n        const counter = serverData\r\n          .map(v => v.cvssScores)\r\n          .reduce((r, row) => {\r\n            r[Math.round(row.baseScore)] = ++r[Math.round(row.baseScore)] || 1;\r\n            return r;\r\n          }, {});\r\n\r\n        setChartData([counter])\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Paper elevation={2} className={'chart-paper'}>\r\n        <label className={'chart-label'}>Base Score Distribution</label>\r\n        <BarChart\r\n          width={500}\r\n          height={300}\r\n          data={chartData}\r\n          barGap={20}\r\n          margin={{\r\n            top: 5, right: 30, left: 20, bottom: 5,\r\n          }}\r\n        >\r\n          <CartesianGrid strokeDasharray=\"3 3\"/>\r\n          <XAxis dataKey=\"name\"/>\r\n          <YAxis/>\r\n          <Tooltip/>\r\n          <Legend/>\r\n          <Bar dataKey=\"0\" fill=\"green\"/>\r\n          <Bar dataKey=\"1\" fill=\"forestgreen\"/>\r\n          <Bar dataKey=\"2\" fill=\"greenyellow\"/>\r\n          <Bar dataKey=\"3\" fill=\"yellowgreen\"/>\r\n          <Bar dataKey=\"4\" fill=\"yellow\"/>\r\n          <Bar dataKey=\"5\" fill=\"coral\"/>\r\n          <Bar dataKey=\"6\" fill=\"orange\"/>\r\n          <Bar dataKey=\"7\" fill=\"darkorange\"/>\r\n          <Bar dataKey=\"8\" fill=\"orangered\"/>\r\n          <Bar dataKey=\"9\" fill=\"red\"/>\r\n          <Bar dataKey=\"10\" fill=\"darkred\"/>\r\n        </BarChart>\r\n      </Paper>\r\n    </React.Fragment>\r\n  )\r\n\r\n}\r\n","import React from \"react\";\r\nimport BarChart from \"recharts/lib/chart/BarChart\";\r\nimport CartesianGrid from \"recharts/lib/cartesian/CartesianGrid\";\r\nimport XAxis from \"recharts/lib/cartesian/XAxis\";\r\nimport YAxis from \"recharts/lib/cartesian/YAxis\";\r\nimport Tooltip from \"recharts/lib/component/Tooltip\";\r\nimport Legend from \"recharts/lib/component/Legend\";\r\nimport Bar from \"recharts/lib/cartesian/Bar\";\r\nimport {fetchWrapper} from \"../../graphql/ApiService\";\r\nimport {chartState} from \"../../graphql/vulnerability\";\r\nimport {SnackBarCtx} from \"../../context/SnackBarContext\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\n\r\nimport './ChartStates.css'\r\n\r\nexport default function ScoresEnvDistribution(props) {\r\n\r\n  const [chartData, setChartData] = React.useState([]);\r\n  const {state, dispatch} = React.useContext(SnackBarCtx);\r\n\r\n  React.useEffect(() => {\r\n    fetchWrapper(chartState)\r\n      .then(resData => {\r\n        const serverData = resData.data.vulnerabilities;\r\n        const counter = serverData\r\n          .map(v => v.cvssScores)\r\n          .reduce((r, row) => {\r\n            r[Math.round(row.environmentalScore)] = ++r[Math.round(row.environmentalScore)] || 1;\r\n            return r;\r\n          }, {});\r\n\r\n        setChartData([counter])\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Paper elevation={2} className={'chart-paper'}>\r\n        <label className={'chart-label'}>Environmental Score Distribution</label>\r\n        <BarChart\r\n          width={500}\r\n          height={300}\r\n          data={chartData}\r\n          barGap={20}\r\n          margin={{\r\n            top: 5, right: 30, left: 20, bottom: 5,\r\n          }}\r\n        >\r\n          <CartesianGrid strokeDasharray=\"3 3\"/>\r\n          <XAxis dataKey=\"name\"/>\r\n          <YAxis/>\r\n          <Tooltip/>\r\n          <Legend/>\r\n          <Bar dataKey=\"0\" fill=\"green\"/>\r\n          <Bar dataKey=\"1\" fill=\"forestgreen\"/>\r\n          <Bar dataKey=\"2\" fill=\"greenyellow\"/>\r\n          <Bar dataKey=\"3\" fill=\"yellowgreen\"/>\r\n          <Bar dataKey=\"4\" fill=\"yellow\"/>\r\n          <Bar dataKey=\"5\" fill=\"coral\"/>\r\n          <Bar dataKey=\"6\" fill=\"orange\"/>\r\n          <Bar dataKey=\"7\" fill=\"darkorange\"/>\r\n          <Bar dataKey=\"8\" fill=\"orangered\"/>\r\n          <Bar dataKey=\"9\" fill=\"red\"/>\r\n          <Bar dataKey=\"10\" fill=\"darkred\"/>\r\n        </BarChart>\r\n      </Paper>\r\n    </React.Fragment>\r\n  )\r\n\r\n}\r\n","import React from \"react\";\r\nimport Tooltip from \"recharts/lib/component/Tooltip\";\r\nimport {fetchWrapper} from \"../../graphql/ApiService\";\r\nimport {chartState} from \"../../graphql/vulnerability\";\r\nimport {SnackBarCtx} from \"../../context/SnackBarContext\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\n\r\nimport './ChartStates.css'\r\nimport RadarChart from \"recharts/lib/chart/RadarChart\";\r\nimport PolarGrid from \"recharts/lib/polar/PolarGrid\";\r\nimport PolarAngleAxis from \"recharts/lib/polar/PolarAngleAxis\";\r\nimport PolarRadiusAxis from \"recharts/lib/polar/PolarRadiusAxis\";\r\nimport Radar from \"recharts/lib/polar/Radar\";\r\n\r\nexport default function SeverityBase(props) {\r\n\r\n  const [chartData, setChartData] = React.useState([]);\r\n  const {state, dispatch} = React.useContext(SnackBarCtx);\r\n  React.useEffect(() => {\r\n    fetchWrapper(chartState)\r\n      .then(resData => {\r\n        const serverData = resData.data.vulnerabilities;\r\n        const result = serverData\r\n          .map(v => v.cvssScores)\r\n          .reduce((r, row) => {\r\n            r[row.baseSeverity] = ++r[row.baseSeverity] || 1;\r\n            return r;\r\n          }, {});\r\n\r\n        const counter = ['NONE', 'LOW', 'MEDIUM', 'HIGH', 'CRITICAL'].map(k => {\r\n          return {type: k, count: result[k]};\r\n        });\r\n\r\n        setChartData(counter)\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Paper elevation={2} className={'chart-paper'}>\r\n        <label className={'chart-label'}>Base Severity</label>\r\n        <RadarChart cx={250} cy={200} outerRadius={100} width={500} height={400} data={chartData}>\r\n          <PolarGrid/>\r\n          <PolarAngleAxis dataKey=\"type\" tick={{fontSize: 10}}/>\r\n          <PolarRadiusAxis/>\r\n          <Radar name=\"baseSeverity\" dataKey=\"count\" stroke=\"#8884d8\" fill=\"#8884d8\" fillOpacity={0.6}/>\r\n          <Tooltip/>\r\n        </RadarChart>\r\n      </Paper>\r\n    </React.Fragment>\r\n  )\r\n\r\n}\r\n","import React from \"react\";\r\nimport Tooltip from \"recharts/lib/component/Tooltip\";\r\nimport {fetchWrapper} from \"../../graphql/ApiService\";\r\nimport {chartState} from \"../../graphql/vulnerability\";\r\nimport {SnackBarCtx} from \"../../context/SnackBarContext\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\n\r\nimport './ChartStates.css'\r\nimport RadarChart from \"recharts/lib/chart/RadarChart\";\r\nimport PolarGrid from \"recharts/lib/polar/PolarGrid\";\r\nimport PolarAngleAxis from \"recharts/lib/polar/PolarAngleAxis\";\r\nimport PolarRadiusAxis from \"recharts/lib/polar/PolarRadiusAxis\";\r\nimport Radar from \"recharts/lib/polar/Radar\";\r\n\r\nexport default function SeverityEnvironmental(props) {\r\n\r\n  const [chartData, setChartData] = React.useState([]);\r\n  const {state, dispatch} = React.useContext(SnackBarCtx);\r\n  React.useEffect(() => {\r\n    fetchWrapper(chartState)\r\n      .then(resData => {\r\n        const serverData = resData.data.vulnerabilities;\r\n        const result = serverData\r\n          .map(v => v.cvssScores)\r\n          .reduce((r, row) => {\r\n            r[row.environmentalSeverity] = ++r[row.environmentalSeverity] || 1;\r\n            return r;\r\n          }, {});\r\n\r\n        const counter = ['NONE', 'LOW', 'MEDIUM', 'HIGH', 'CRITICAL'].map(k => {\r\n          return {type: k, count: result[k]};\r\n        });\r\n\r\n        setChartData(counter)\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Paper elevation={2} className={'chart-paper'}>\r\n        <label className={'chart-label'}>Environmental Severity</label>\r\n        <RadarChart cx={250} cy={200} outerRadius={100} width={500} height={400} data={chartData}>\r\n          <PolarGrid/>\r\n          <PolarAngleAxis dataKey=\"type\" tick={{fontSize: 10}}/>\r\n          <PolarRadiusAxis/>\r\n          <Radar name=\"environmentalSeverity\" dataKey=\"count\" stroke=\"#8884d8\" fill=\"#8884d8\" fillOpacity={0.6}/>\r\n          <Tooltip/>\r\n        </RadarChart>\r\n      </Paper>\r\n    </React.Fragment>\r\n  )\r\n\r\n}\r\n","import React from \"react\";\r\nimport Tooltip from \"recharts/lib/component/Tooltip\";\r\nimport {fetchWrapper} from \"../../graphql/ApiService\";\r\nimport {chartState} from \"../../graphql/vulnerability\";\r\nimport {SnackBarCtx} from \"../../context/SnackBarContext\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\n\r\nimport './ChartStates.css'\r\nimport RadarChart from \"recharts/lib/chart/RadarChart\";\r\nimport PolarGrid from \"recharts/lib/polar/PolarGrid\";\r\nimport PolarAngleAxis from \"recharts/lib/polar/PolarAngleAxis\";\r\nimport PolarRadiusAxis from \"recharts/lib/polar/PolarRadiusAxis\";\r\nimport Radar from \"recharts/lib/polar/Radar\";\r\n\r\nexport default function SeverityTemporal(props) {\r\n\r\n  const [chartData, setChartData] = React.useState([]);\r\n  const {state, dispatch} = React.useContext(SnackBarCtx);\r\n  React.useEffect(() => {\r\n    fetchWrapper(chartState)\r\n      .then(resData => {\r\n        const serverData = resData.data.vulnerabilities;\r\n        const result = serverData\r\n          .map(v => v.cvssScores)\r\n          .reduce((r, row) => {\r\n            r[row.temporalSeverity] = ++r[row.temporalSeverity] || 1;\r\n            return r;\r\n          }, {});\r\n\r\n        const counter = ['NONE', 'LOW', 'MEDIUM', 'HIGH', 'CRITICAL'].map(k => {\r\n          return {type: k, count: result[k]};\r\n        });\r\n\r\n        setChartData(counter)\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Paper elevation={2} className={'chart-paper'}>\r\n        <label className={'chart-label'}>Temporal Severity</label>\r\n        <RadarChart cx={250} cy={200} outerRadius={100} width={500} height={400} data={chartData}>\r\n          <PolarGrid/>\r\n          <PolarAngleAxis dataKey=\"type\" tick={{fontSize: 10}}/>\r\n          <PolarRadiusAxis/>\r\n          <Radar name=\"temporalSeverity\" dataKey=\"count\" stroke=\"#8884d8\" fill=\"#8884d8\" fillOpacity={0.6}/>\r\n          <Tooltip/>\r\n        </RadarChart>\r\n      </Paper>\r\n    </React.Fragment>\r\n  )\r\n\r\n}\r\n","import React from 'react'\r\nimport ChartStates from \"../components/charts/ChartStates\";\r\nimport ChartOverdueStates from \"../components/charts/ChartOverdueStates\";\r\n\r\nimport './Cvss.css'\r\nimport AttackVector from \"../components/charts/AttackVector\";\r\nimport ExploitCodeMaturity from \"../components/charts/ExploitCodeMaturity\";\r\nimport ScoresTemDistribution from \"../components/charts/ScoresTemDistribution\";\r\nimport ScoresBaseDistribution from \"../components/charts/ScoresBaseDistribution\";\r\nimport ScoresEnvDistribution from \"../components/charts/ScoresEnvDistribution\";\r\nimport SeverityBase from \"../components/charts/SeverityBase\";\r\nimport SeverityEnvironmental from \"../components/charts/SeverityEnvironmental\";\r\nimport SeverityTemporal from \"../components/charts/SeverityTemporal\";\r\n\r\nexport default function CvssPage(props) {\r\n  return (\r\n    <React.Fragment>\r\n      <section className={'charts'}>\r\n        <ChartStates/>\r\n        <ChartOverdueStates/>\r\n        <AttackVector/>\r\n        <ExploitCodeMaturity/>\r\n\r\n        <ScoresBaseDistribution/>\r\n        <SeverityBase/>\r\n        <ScoresTemDistribution/>\r\n        <SeverityTemporal/>\r\n        <ScoresEnvDistribution/>\r\n        <SeverityEnvironmental/>\r\n      </section>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n","import React from 'react'\r\nimport {useHistory} from 'react-router-dom';\r\nimport './Vulnerabilities.css'\r\nimport MaterialTable from \"material-table\";\r\n\r\nimport {tableQuery, deleteVulnerability} from '../graphql/vulnerability'\r\nimport {fetchWrapper} from \"../graphql/ApiService\";\r\nimport {SnackBarCtx} from \"../context/SnackBarContext\";\r\nimport {LoginCtx} from \"../context/LoginContext\";\r\n\r\n\r\nfunction Vulnerabilities(props) {\r\n  const history = useHistory();\r\n  const [tableData, setTableData] = React.useState([]);\r\n  const {state, dispatch} = React.useContext(SnackBarCtx);\r\n  const {authState} = React.useContext(LoginCtx);\r\n\r\n  React.useEffect(() => {\r\n    fetchWrapper(tableQuery)\r\n      .then(resData => {\r\n        setTableData(resData.data.vulnerabilities)\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const deleteHandler = (event, rowData) => {\r\n    const bodyRequest = deleteVulnerability(rowData._id)\r\n    fetchWrapper(bodyRequest)\r\n      .then(resData => {\r\n        setTableData(resData.data.deleteVulnerability)\r\n        dispatch({type: \"OPEN\", msg: 'Vulnerability has been removed'})\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n\r\n  }\r\n\r\n  const getActions = () => {\r\n    let actions = [];\r\n    actions.push({\r\n      icon: 'visibility',\r\n      tooltip: 'View/Edit',\r\n      onClick: (event, rowData) => {\r\n        history.push({\r\n          pathname: `/view/${rowData._id}`\r\n        });\r\n      }\r\n    })\r\n\r\n    if (authState && authState.token)\r\n      actions.push({\r\n        icon: 'delete',\r\n        tooltip: 'Delete',\r\n        onClick: (event, rowData) => deleteHandler(event, rowData)\r\n      })\r\n\r\n    return actions;\r\n  }\r\n\r\n  const columns = [\r\n    {\r\n      title: \"CveId\",\r\n      field: \"cveId\",\r\n    },\r\n    {\r\n      title: \"Title\",\r\n      field: \"title\",\r\n    },\r\n    {\r\n      title: \"vector\",\r\n      field: \"cvss.attackVector\",\r\n    },\r\n    {\r\n      title: \"Complexity\",\r\n      field: \"cvss.attackComplexity\",\r\n    }, {\r\n      title: \"Base Sev.\",\r\n      field: \"cvssScores.baseSeverity\",\r\n    }, {\r\n      title: \"Tmp. Sev.\",\r\n      field: \"cvssScores.temporalSeverity\",\r\n    }, {\r\n      title: \"Env. Sev.\",\r\n      field: \"cvssScores.environmentalSeverity\",\r\n    }\r\n  ];\r\n\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className={'vulnerabilities-table'}>\r\n        <MaterialTable\r\n          title=\"Vulnerabilities\"\r\n          data={tableData}\r\n          columns={columns}\r\n          options={{search: false, paging: true, filtering: true, exportButton: false}}\r\n          isLoading={false}\r\n          actions={getActions()}\r\n        />\r\n      </div>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\nexport default Vulnerabilities\r\n","import React from 'react'\nimport {NavLink} from 'react-router-dom'\nimport {LoginCtx} from '../../context/LoginContext'\nimport './MainNavigation.css'\n\nexport default function MainNavigation(props) {\n\n  const {authState, dispatchAuth} = React.useContext(LoginCtx)\n\n  const handleLogout = (event) => {\n    event.preventDefault()\n    dispatchAuth({type: \"LOGOUT\", authData: {}})\n  }\n\n  return (\n    <React.Fragment>\n      <header className=\"main-navigation\">\n        <div className=\"main-navigation-logo\">\n          <h1>Vulnerability Manager</h1>\n        </div>\n        <nav className=\"main-navigation-items\">\n          <ul>\n            {authState.token && <li><NavLink to=\"/create-vulnerability\">Create</NavLink></li>}\n            <li><NavLink to=\"/vulnerabilities\">Vulnerabilities</NavLink></li>\n            {authState.token && <li><NavLink to=\"/cvss\">cvss</NavLink></li>}\n            {!authState.token && <li><NavLink to=\"/login\">Login</NavLink></li>}\n            {authState.token && <li>\n              <button onClick={handleLogout}>Logout</button>\n            </li>}\n          </ul>\n        </nav>\n      </header>\n    </React.Fragment>\n  )\n}\n\n","import React, {useState} from 'react'\r\nimport {useHistory} from 'react-router-dom';\r\nimport './CreateVulnerability.css'\r\nimport {fetchWrapper} from \"../graphql/ApiService\";\r\nimport {createVulnerability} from \"../graphql/vulnerability\";\r\nimport {SnackBarCtx} from \"../context/SnackBarContext\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport Select from '@material-ui/core/Select';\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport TextareaAutosize from \"@material-ui/core/TextareaAutosize\";\r\n\r\nfunction CreateVulnerability(props) {\r\n  const history = useHistory();\r\n  const {state, dispatch} = React.useContext(SnackBarCtx);\r\n\r\n  const [cveId, setCveId] = useState(\"\");\r\n  const [title, setTitle] = useState(\"\");\r\n  const [description, setDescription] = useState(\"\");\r\n  const [vState, setVState] = useState(\"OPEN\");\r\n  const [selectedDate, setSelectedDate] = React.useState(Date.now());\r\n\r\n\r\n  const handleSubmit = (event) => {\r\n    event.preventDefault();\r\n    const requestBody = createVulnerability(cveId, title, description, vState, selectedDate);\r\n    fetchWrapper(requestBody)\r\n      .then(resData => {\r\n        dispatch({type: \"OPEN\", msg: 'Vulnerability successfully created.'})\r\n        history.push({\r\n          pathname: `/view/${resData.data.createVulnerability._id}`\r\n        });\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n  }\r\n\r\n  const handleDate = (event) => {\r\n    event.preventDefault();\r\n    const time = new Date(event.target.value).getTime();\r\n    setSelectedDate(time)\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div>\r\n        <header><h3>Create new Vulnerability</h3></header>\r\n        <form onSubmit={handleSubmit}>\r\n          <section className={'create-section-row'}>\r\n            <div className={'section-header'}>\r\n              <TextField\r\n                className={'section-header-item'}\r\n                id=\"cveIdInput\"\r\n                name=\"cveId\"\r\n                type=\"text\"\r\n                label=\"Cve ID\"\r\n                placeholder=\"Add CVE-ID\"\r\n                onChange={e => setCveId(e.target.value)}\r\n                required\r\n                InputLabelProps={{\r\n                  shrink: true,\r\n                }}\r\n              />\r\n              <div className={'section-header-item'}>\r\n                <InputLabel id={'stateLabel'}>State</InputLabel>\r\n                <Select\r\n                  id={'stateSelect'}\r\n                  name={'state'}\r\n                  labelId={\"stateLabel\"}\r\n                  required\r\n                  value={vState}\r\n                  defaultValue={\"OPEN\"}\r\n                  onChange={e => setVState(e.target.value)}\r\n                >\r\n                  <MenuItem value={\"OPEN\"}>OPEN</MenuItem>\r\n                  <MenuItem value={\"FIXED\"}>FIXED</MenuItem>\r\n                  <MenuItem value={\"PENDING\"}>PENDING</MenuItem>\r\n                  <MenuItem value={\"REVIEW\"}>REVIEW</MenuItem>\r\n                  <MenuItem value={\"TESTING\"}>TESTING</MenuItem>\r\n                </Select>\r\n              </div>\r\n              <TextField\r\n                className={'section-header-item'}\r\n                id=\"date\"\r\n                label=\"Due Date\"\r\n                type=\"date\"\r\n                required\r\n                defaultValue=\"2021-01-01\"\r\n                onChange={handleDate}\r\n                InputLabelProps={{\r\n                  shrink: true,\r\n                }}\r\n              />\r\n            </div>\r\n          </section>\r\n          <section className={'create-section-row'}>\r\n            <TextField\r\n              id=\"titleInput\"\r\n              name=\"title\"\r\n              type=\"text\"\r\n              label=\"Title\"\r\n              placeholder=\"Add title\"\r\n              onChange={e => setTitle(e.target.value)}\r\n              required\r\n              InputLabelProps={{\r\n                shrink: true,\r\n              }}\r\n            />\r\n          </section>\r\n          <section className={'create-section-row'}>\r\n            <label>Description</label>\r\n            <TextareaAutosize\r\n              id={\"description\"}\r\n              label={\"Description\"}\r\n              onChange={e => setDescription(e.target.value)}\r\n              placeholder=\"Add description\"\r\n              name=\"description\"\r\n              rows={4}\r\n              required\r\n            />\r\n          </section>\r\n          <section className={'create-section-row'}>\r\n            <button className={'btn'} type=\"submit\">Confirm</button>\r\n          </section>\r\n        </form>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\nexport default CreateVulnerability\r\n","import Divider from \"@material-ui/core/Divider\";\r\nimport React from \"react\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\n\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  divider: {\r\n    width: '100%',\r\n    backgroundColor: \"lightgrey\",\r\n    margin: \"10px 0px\",\r\n  },\r\n}));\r\n\r\nexport default function CustomDivider(props) {\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <Divider className={classes.divider}/>\r\n  )\r\n}\r\n","import './ViewArrayField.css'\r\nimport {fetchWrapper} from '../../graphql/ApiService'\r\nimport {getSimplifiedVulnerability} from '../../graphql/vulnerability'\r\n\r\n\r\nimport React from \"react\";\r\n\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport TextareaAutosize from \"@material-ui/core/TextareaAutosize\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport CustomDivider from \"./CustomDivider\";\r\nimport {SnackBarCtx} from \"../../context/SnackBarContext\";\r\n\r\n\r\n\r\nexport default function ViewArrayField(props) {\r\n  const { state, dispatch } = React.useContext(SnackBarCtx);\r\n  const vulnerabilityId = props.vulnerabilityId;\r\n  const fieldArrayId = props.field;\r\n  const label = props.label;\r\n  const editMode = props.editMode;\r\n  const [arrayData, setArrayData] = React.useState([])\r\n  const newItemRef = React.createRef();\r\n\r\n\r\n  React.useEffect(() => {\r\n    fetchWrapper(getSimplifiedVulnerability(vulnerabilityId, fieldArrayId))\r\n      .then(resData => {\r\n        const vulnerability = resData.data.getVulnerability;\r\n        setArrayData(vulnerability[fieldArrayId]);\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n// eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const addNew = (event) => {\r\n    event.preventDefault()\r\n    const value = newItemRef.current.value;\r\n    newItemRef.current.value = '';\r\n    setArrayData(prevState => [...prevState, value])\r\n\r\n  }\r\n\r\n  const removeElem = (index) => () => {\r\n    setArrayData(prevState => {\r\n      prevState.splice(index, 1)\r\n      return [...prevState]\r\n    })\r\n  }\r\n\r\n  const submitChanges = (event) => {\r\n    event.preventDefault()\r\n    const arrBuilder = arrayData.map((ele) => `\"${ele}\"`).join(',')\r\n    const requestBody = {\r\n      query: `\r\n      mutation {\r\n        addArrayEntry(id: \"${vulnerabilityId}\", fieldId: \"${fieldArrayId}\", values: [${arrBuilder}]) {\r\n          ${fieldArrayId}\r\n        }\r\n      }\r\n      `\r\n    }\r\n    fetchWrapper(requestBody)\r\n      .then(resData => {\r\n        const res = resData.data.addArrayEntry;\r\n        setArrayData(res[fieldArrayId]);\r\n        dispatch({ type: \"OPEN\", msg: `${label} successfully updated.` })\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <section className={'view-array'}>\r\n        <label className={'view-array-title'}>{label}</label>\r\n        {arrayData.map((elem, index) => {\r\n            return <div key={`${index}Div`} className={'view-array-elem'}>\r\n              {editMode &&\r\n              <IconButton key={`${index}IconButton`} type=\"submit\" color=\"default\" aria-label=\"upload picture\" component=\"span\"\r\n                          onClick={removeElem(index)}>\r\n                <DeleteIcon key={`${index}icon`}/>\r\n              </IconButton>}\r\n              <Paper key={index} className={'view-array-paper'} elevation={2}>{elem}</Paper>\r\n            </div>\r\n          }\r\n        )}\r\n      </section>\r\n      {editMode && <section className={'view-array-form'}>\r\n        <form onSubmit={addNew}>\r\n          <label>Add new:</label>\r\n          <div className={'view-array-addnew'}>\r\n            <TextareaAutosize ref={newItemRef} required/>\r\n            <Button variant={\"outlined\"} color=\"primary\" type=\"submit\">Add</Button>\r\n          </div>\r\n\r\n        </form>\r\n\r\n        <CustomDivider />\r\n        <div className={\"action-button-save\"}>\r\n          <Button variant=\"contained\" color=\"primary\" size=\"small\" onClick={submitChanges}>\r\n            Save\r\n          </Button>\r\n        </div>\r\n      </section>\r\n      }\r\n    </React.Fragment>\r\n  )\r\n}\r\n","import React from \"react\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\n\r\nimport './ViewGenericScoresBar.css'\r\n\r\nexport default function ViewGenericScoresBar(props) {\r\n  const scores = props.scoresData;\r\n\r\n  const getStyle = (sev) => {\r\n    let viewColor = \"green\"\r\n    if (sev === 'LOW') viewColor = 'orange';\r\n    if (sev === 'MEDIUM') viewColor = 'orangered';\r\n    if (sev === 'HIGH' || sev === 'CRITICAL') viewColor = 'red';\r\n\r\n    return {backgroundColor: viewColor, color: 'white', marginLeft: '10px'};\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <section className={'toolbar-scores'}>\r\n        <div className={'toolbar-group-scores'}>\r\n          <label>Base:</label>\r\n          {scores && <Chip label={scores.baseScore} style={getStyle(scores.baseSeverity)}/>}\r\n          {scores && <Chip label={scores.baseSeverity} style={getStyle(scores.baseSeverity)}/>}\r\n        </div>\r\n        <div className={'toolbar-group-scores'}>\r\n          <label>Temporal:</label>\r\n          {scores && <Chip label={scores.temporalScore} style={getStyle(scores.temporalSeverity)}/>}\r\n          {scores && <Chip label={scores.temporalSeverity} style={getStyle(scores.temporalSeverity)}/>}\r\n        </div>\r\n        <div className={'toolbar-group-scores'}>\r\n          <label>Environmental:</label>\r\n          {scores && <Chip label={scores.environmentalScore} style={getStyle(scores.environmentalSeverity)}/>}\r\n          {scores && <Chip label={scores.environmentalSeverity} style={getStyle(scores.environmentalSeverity)}/>}\r\n        </div>\r\n      </section>\r\n    </React.Fragment>\r\n  )\r\n}\r\n","import React from \"react\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport TextareaAutosize from \"@material-ui/core/TextareaAutosize\";\r\nimport {getSimplifiedVulnerability, updateVulnerability} from \"../../graphql/vulnerability\";\r\nimport {fetchWrapper} from \"../../graphql/ApiService\";\r\nimport CustomDivider from \"./CustomDivider\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport ViewGenericScoresBar from \"./ViewGenericScoresBar\";\r\nimport {cvssScoresFields} from \"../../graphql/Cvss\"\r\nimport {SnackBarCtx} from \"../../context/SnackBarContext\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Input from \"@material-ui/core/Input\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\n\r\n\r\n\r\nimport './GenericEdit.css'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  icon: {}, noIcon: {\r\n    display: \"none\"\r\n  }\r\n}));\r\n\r\nexport default function GenericEdit(props) {\r\n  const classes = useStyles();\r\n  const {state, dispatch} = React.useContext(SnackBarCtx);\r\n  const vulnerabilityId = props.vulnerabilityId;\r\n  const editMode = props.editMode;\r\n  const [data, setData] = React.useState({})\r\n\r\n\r\n  React.useEffect(() => {\r\n    const bodyRequest = getSimplifiedVulnerability(vulnerabilityId, `cveId title description state dueDate ${cvssScoresFields}`);\r\n    fetchWrapper(bodyRequest)\r\n      .then(resData => {\r\n        const vulnerability = resData.data.getVulnerability;\r\n        setData(vulnerability);\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n\r\n  const onChangeFn = (event) => {\r\n    const {name, value} = event.target;\r\n    setData(prev => {\r\n      return {...prev, [name]: value}\r\n    })\r\n    // this.setValue({value: value});\r\n  }\r\n\r\n  const onChangeDateFn = (event) => {\r\n    const {name, value} = event.target;\r\n    setData(prev => {\r\n      return {...prev, [name]: new Date(value).getTime()}\r\n    })\r\n  }\r\n\r\n\r\n  const submitChanges = (event) => {\r\n    event.preventDefault()\r\n\r\n    const requestBody = updateVulnerability(data);\r\n    fetchWrapper(requestBody)\r\n      .then(resData => {\r\n        const res = resData.data.updateVulnerability;\r\n        setData(prevState => {\r\n          return {...prevState, title: res.title, description: res.description}\r\n        });\r\n        dispatch({type: \"OPEN\", msg: 'Vulnerability info successfully updated.'})\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n\r\n  }\r\n\r\n  const getFormattedDate = () => {\r\n    let dateObj = new Date(Date.now())\r\n    if (data.dueDate) {\r\n      dateObj = new Date(parseInt(data.dueDate))\r\n    }\r\n\r\n    const day = (dateObj.getDate() < 10 ? '0' : '') + dateObj.getDate();\r\n    const month = ((dateObj.getMonth() + 1) < 10 ? '0' : '') + (dateObj.getMonth() + 1);\r\n    return `${dateObj.getFullYear()}-${month}-${day}`; // expect format \"2021-01-01\"\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      {!editMode && <ViewGenericScoresBar\r\n        scoresData={data.cvssScores}\r\n        editMode={editMode}\r\n      />}\r\n      <form className={`view-edit-form`}>\r\n        <section className={'view-edit-elm'}>\r\n          <section className={'view-edit-elem-row'}>\r\n            <TextField className={`view-edit-elem-row-elem`}\r\n                       id=\"cveId\"\r\n                       label=\"CVE-ID\"\r\n                       value={data.cveId + ' '}\r\n                       onChange={onChangeFn}\r\n                       InputProps={{\r\n                         readOnly: true,\r\n                         disableUnderline: true,\r\n                       }}\r\n            />\r\n            <section className={'view-edit-elem-row-elem'}>\r\n              <InputLabel id={'stateLabel'}>State</InputLabel>\r\n              <Select id={'stateSelect'}\r\n                      name={'state'}\r\n                      labelId={\"stateLabel\"}\r\n                      value={data.state + \"\"}\r\n                      onChange={onChangeFn}\r\n                      classes={{\r\n                        icon: editMode ? classes.icon : classes.noIcon\r\n                      }}\r\n                      input={\r\n                        <Input\r\n                          disableUnderline={!editMode}\r\n                          readOnly={!editMode}\r\n                        />\r\n                      }>\r\n                <MenuItem value={\"OPEN\"}>OPEN</MenuItem>\r\n                <MenuItem value={\"FIXED\"}>FIXED</MenuItem>\r\n                <MenuItem value={\"PENDING\"}>PENDING</MenuItem>\r\n                <MenuItem value={\"REVIEW\"}>REVIEW</MenuItem>\r\n                <MenuItem value={\"TESTING\"}>TESTING</MenuItem>\r\n              </Select>\r\n            </section>\r\n            <TextField className={'view-edit-elem-row-elem'}\r\n                       id=\"dueDate\"\r\n                       label=\"Due Date\"\r\n                       name={\"dueDate\"}\r\n                       type=\"date\"\r\n                       value={getFormattedDate()}\r\n                       onChange={onChangeDateFn}\r\n\r\n                       InputProps={{\r\n                         inputProps: classes.inputProps,\r\n                         readOnly: !editMode,\r\n                         disableUnderline: !editMode,\r\n                       }}\r\n\r\n            />\r\n          </section>\r\n        </section>\r\n        <TextField id=\"title\" label=\"Title\" className={'view-edit-elm'}\r\n                   value={data.title + ' '}\r\n                   onChange={onChangeFn}\r\n                   name={'title'}\r\n                   InputProps={{\r\n                     readOnly: !editMode,\r\n                     disableUnderline: !editMode,\r\n                   }}/>\r\n        <div className={'view-edit-elm'}>\r\n          <label>Description</label>\r\n          {editMode && <TextareaAutosize id=\"description\" label=\"description\" name={'description'}\r\n                                         rowsMin={3}\r\n                                         defaultValue={data.description} onChange={onChangeFn}/>\r\n          }\r\n          {!editMode && <p>{data.description}</p>}\r\n\r\n        </div>\r\n      </form>\r\n      {editMode && <section>\r\n        <CustomDivider/>\r\n        <div className={\"action-button-save\"}>\r\n          <Button variant=\"contained\" color=\"primary\" size=\"small\" onClick={submitChanges}>\r\n            Save\r\n          </Button>\r\n        </div>\r\n      </section>\r\n      }\r\n\r\n    </React.Fragment>\r\n  )\r\n}\r\n","import React from \"react\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\n\r\nimport './ViewCvssSection.css'\r\nimport Input from \"@material-ui/core/Input\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\n\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  icon: {}, noIcon: {\r\n    display: \"none\"\r\n  },\r\n}));\r\n\r\nexport default function ViewCvssSection(props) {\r\n  const classes = useStyles();\r\n  const idSection = props.idSection;\r\n  const editMode = props.editMode;\r\n  const fieldsArray = props.fieldsArray;\r\n  const cvssData = props.cvssData;\r\n  const [scoreValue, scoreSeverity] = props.scoresData;\r\n  const helper = props.helper;\r\n  const handleChange = props.handleChange;\r\n\r\n  const getEnumOptions = (name) => {\r\n    if (Object.keys(helper).length > 0)\r\n      return helper.filter(item => item.name === name)[0];\r\n    return helper\r\n  }\r\n\r\n  const getEnumValues = (name) => {\r\n    if (Object.keys(helper).length > 0) {\r\n      return getEnumOptions(name).type.enumValues\r\n    }\r\n    return [];\r\n  }\r\n\r\n  const getLabel = (itemId) => {\r\n    return itemId[0].toUpperCase() + itemId.slice(1);\r\n  }\r\n\r\n\r\n  const getStyle = (sev) => {\r\n    let viewColor = \"green\"\r\n    if (sev === 'LOW') viewColor = 'orange';\r\n    if (sev === 'MEDIUM') viewColor = 'orangered';\r\n    if (sev === 'HIGH' || sev === 'CRITICAL') viewColor = 'red';\r\n\r\n    return {backgroundColor: viewColor, color: 'white', marginLeft: '10px'};\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Paper className={\"cvss-group-paper\"} elevation={2}>\r\n        <label className={\"cvss-group-title\"}>{idSection + ' Score'}</label>\r\n        <div className={'cvss-group-scores'}>\r\n          <Chip label={scoreValue} style={getStyle(scoreSeverity)}/>\r\n          <Chip label={scoreSeverity} style={getStyle(scoreSeverity)}/>\r\n        </div>\r\n      </Paper>\r\n      <section className={'cvss-group'}>\r\n        {fieldsArray.map(itemId => {\r\n          return (\r\n            <div key={itemId + 'Div'} className={\"cvss-group-item\"}>\r\n              <InputLabel key={itemId + 'Label'} id=\"demo-simple-select-label\">{getLabel(itemId)}</InputLabel>\r\n              <Select\r\n                key={itemId + 'Select'}\r\n                labelId={itemId}\r\n                name={itemId}\r\n                id={itemId}\r\n                value={cvssData[itemId] + \"\"}\r\n                onChange={handleChange}\r\n                classes={{\r\n                  icon: editMode ? classes.icon : classes.noIcon\r\n                }}\r\n                input={\r\n                  <Input\r\n                    disableUnderline={!editMode}\r\n                    readOnly={!editMode}\r\n                  />\r\n                }\r\n              >\r\n                {\r\n                  getEnumValues(itemId).map(enumOp => <MenuItem\r\n                    key={enumOp.name + 'MenuItem'}\r\n                    value={enumOp.name + \"\"}\r\n                    dense={true}>\r\n                    {enumOp.name}</MenuItem>)\r\n                }\r\n              </Select>\r\n            </div>\r\n          )\r\n        })}\r\n      </section>\r\n    </React.Fragment>\r\n  )\r\n}\r\n","import React from \"react\";\r\nimport {fetchWrapper} from \"../../graphql/ApiService\";\r\nimport {getVulnerabilityFn} from \"../../graphql/vulnerability\";\r\nimport {queryTypes, mutationQuery} from \"../../graphql/Cvss\";\r\n\r\n\r\nimport ViewCvssSection from \"./ViewCvssSection\";\r\nimport CustomDivider from \"./CustomDivider\";\r\nimport Button from \"@material-ui/core/Button\";\r\n\r\nimport './ViewCvss.css'\r\nimport {SnackBarCtx} from \"../../context/SnackBarContext\";\r\n\r\nexport default function ViewCvss(props) {\r\n  const { state, dispatch } = React.useContext(SnackBarCtx);\r\n  const vulnerabilityId = props.vulnerabilityId;\r\n  const editMode = props.editMode;\r\n  const [cvssData, setCvssData] = React.useState({})\r\n  const [scoresData, setScoresData] = React.useState({})\r\n  const [helper, setHelper] = React.useState({})\r\n  const base = ['attackVector', 'attackComplexity', 'privilegesRequired', 'userInteraction', 'scope', 'confidentialityImpact', 'integrityImpact', 'availabilityImpact'];\r\n  const temporal = ['exploitCodeMaturity', 'remediationLevel', 'reportConfidence']\r\n  const environment = ['confidentialityRequirement', 'integrityRequirement', 'availabilityRequirement', 'modifiedAttackVector', 'modifiedAttackComplexity', 'modifiedPrivilegesRequired', 'modifiedUserInteraction', 'modifiedScope', 'modifiedConfidentialityImpact', 'modifiedIntegrityImpact', 'modifiedAvailabilityImpact']\r\n\r\n  React.useEffect(() => {\r\n    fetchWrapper(queryTypes)\r\n      .then(resData => {\r\n        const types = resData.data.__type.inputFields;\r\n        setHelper(types);\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n\r\n    fetchWrapper(getVulnerabilityFn(vulnerabilityId))\r\n      .then(resData => {\r\n        const cvss = resData.data.getVulnerability.cvss;\r\n        const scores = resData.data.getVulnerability.cvssScores;\r\n        setCvssData(cvss)\r\n        setScoresData(scores)\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const handleChange = (event) => {\r\n    const {name, value} = event.target;\r\n    setCvssData(prev => {\r\n      return {...prev, [name]: value}\r\n    })\r\n  }\r\n\r\n  const submitChanges = (event) => {\r\n    event.preventDefault();\r\n\r\n    const clone = {...cvssData};\r\n    delete clone._id\r\n    const inputBuilder = Object.entries(clone)\r\n      .map(([key, value], i) => `${key}: ${value}`)\r\n      .join(',');\r\n    const requestBody = mutationQuery(cvssData._id, `{${inputBuilder}}`)\r\n    fetchWrapper(requestBody)\r\n      .then(resData => {\r\n        const cvss = resData.data.updateCvss.cvss;\r\n        const scores = resData.data.updateCvss.cvssScores;\r\n        setCvssData(cvss)\r\n        setScoresData(scores)\r\n        dispatch({ type: \"OPEN\", msg: 'CVSS successfully updated.' })\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <ViewCvssSection\r\n        idSection={\"Base\"}\r\n        fieldsArray={base}\r\n        cvssData={cvssData}\r\n        scoresData={[scoresData.baseScore, scoresData.baseSeverity]}\r\n        helper={helper}\r\n        editMode={editMode}\r\n        handleChange={handleChange}\r\n      />\r\n\r\n      <ViewCvssSection\r\n        idSection={\"Temporal\"}\r\n        fieldsArray={temporal}\r\n        cvssData={cvssData}\r\n        scoresData={[scoresData.temporalScore, scoresData.temporalSeverity]}\r\n        helper={helper}\r\n        editMode={editMode}\r\n        handleChange={handleChange}\r\n      />\r\n\r\n      <ViewCvssSection\r\n        idSection={\"Environmental\"}\r\n        fieldsArray={environment}\r\n        cvssData={cvssData}\r\n        scoresData={[scoresData.environmentalScore, scoresData.environmentalSeverity]}\r\n        helper={helper}\r\n        editMode={editMode}\r\n        handleChange={handleChange}\r\n      />\r\n\r\n      {editMode && <section>\r\n        <CustomDivider/>\r\n        <div className={\"action-button-save\"}>\r\n          <Button variant=\"contained\" color=\"primary\" size=\"small\" onClick={submitChanges}>\r\n            Save\r\n          </Button>\r\n        </div>\r\n      </section>\r\n      }\r\n\r\n    </React.Fragment>\r\n  )\r\n}\r\n","import './ViewScores.css'\r\nimport React from \"react\";\r\nimport {fetchWrapper} from \"../../graphql/ApiService\";\r\nimport {getVulnerabilityFn} from \"../../graphql/vulnerability\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport CustomDivider from \"./CustomDivider\";\r\nimport {SnackBarCtx} from \"../../context/SnackBarContext\";\r\n\r\n\r\nexport default function ViewScores(props) {\r\n  const {state, dispatch} = React.useContext(SnackBarCtx);\r\n  const vulnerabilityId = props.vulnerabilityId;\r\n  const [scoresData, setScoresData] = React.useState({})\r\n  let pervLetter = '';\r\n\r\n  React.useEffect(() => {\r\n    fetchWrapper(getVulnerabilityFn(vulnerabilityId))\r\n      .then(resData => {\r\n        const scores = resData.data.getVulnerability.cvssScores;\r\n        delete scores._id;\r\n        setScoresData(scores)\r\n      })\r\n      .catch(err => {\r\n        dispatch({type: \"OPEN\", msg: `${err.message}`})\r\n        console.log(err)\r\n      })\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className={'view-scores'}>\r\n        {\r\n          ['base', 'temporal', 'environment'].map(group => {\r\n            const addSection = pervLetter !== group[0]\r\n            return <section key={group + '-section'} >\r\n              <div key={group + '-div'} className={'view-scores-group'}>\r\n              {Object.entries(scoresData)\r\n                .filter(([key, value]) => key.startsWith(group))\r\n                .map(([key, value]) => {\r\n                  const label = key[0].toUpperCase() + key.slice(1)\r\n                  return (\r\n                    <div key={'section-' + key} className={'view-scores-item'}>\r\n                      <Paper className={'view-scores-item-label'}>{label}</Paper>\r\n                      <div className={'view-scores-item-value'}>{value}</div>\r\n                    </div>\r\n                  )\r\n                })}\r\n              </div>\r\n              {addSection && <CustomDivider/>}\r\n            </section>\r\n          })\r\n\r\n\r\n        }\r\n      </div>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n","import React from \"react\";\r\nimport PropTypes from 'prop-types';\r\n\r\n\r\nimport './ViewVulnerability.css'\r\nimport ViewArrayField from \"./ViewArrayField\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport Switch from \"@material-ui/core/Switch\";\r\nimport GenericEdit from \"./GenericEdit\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport ViewCvss from \"./ViewCvss\";\r\nimport ViewScores from \"./ViewScores\";\r\nimport {LoginCtx} from \"../../context/LoginContext\";\r\n\r\n\r\nfunction TabPanel(props) {\r\n  const {children, value, index, ...other} = props;\r\n\r\n  return (\r\n    <div\r\n      role=\"tabpanel\"\r\n      hidden={value !== index}\r\n      id={`scrollable-auto-tabpanel-${index}`}\r\n      aria-labelledby={`scrollable-auto-tab-${index}`}\r\n      {...other}\r\n    >\r\n      {value === index && (\r\n        <Box p={3}>\r\n          <Typography component={'span'} variant={'body2'}>{children}</Typography>\r\n        </Box>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nTabPanel.propTypes = {\r\n  children: PropTypes.node,\r\n  index: PropTypes.any.isRequired,\r\n  value: PropTypes.any.isRequired,\r\n};\r\n\r\n\r\nconst useStyles = makeStyles({\r\n  root: {\r\n    flexGrow: 1,\r\n  },\r\n});\r\n\r\nfunction ViewVulnerability(props) {\r\n\r\n  const {authState} = React.useContext(LoginCtx);\r\n  const classes = useStyles();\r\n  const vulnerabilityId = props.match.params.id;\r\n  const [isEdit, setIsEdit] = React.useState(false);\r\n  const [value, setValue] = React.useState(0);\r\n\r\n\r\n  const handleEditChange = () => {\r\n    setIsEdit(prevState => !prevState)\r\n  }\r\n  const handleChange = (event, newValue) => {\r\n    setValue(newValue);\r\n  };\r\n\r\n\r\n  return (\r\n\r\n    <React.Fragment>\r\n\r\n      {authState.token && <FormControlLabel\r\n        className={\"edit-mode-switch\"}\r\n        control={\r\n          <Switch\r\n            checked={isEdit}\r\n            onChange={handleEditChange}\r\n            name=\"editMode\"\r\n            color=\"secondary\"\r\n          />\r\n        }\r\n        label=\"Edit Mode\"\r\n      />\r\n      }\r\n      <Paper className={classes.root}>\r\n        <Tabs\r\n          value={value}\r\n          onChange={handleChange}\r\n          indicatorColor=\"primary\"\r\n          textColor=\"primary\"\r\n          centered\r\n        >\r\n          <Tab label=\"Vulnerability\"/>\r\n          <Tab label=\"CVSS\"/>\r\n          <Tab label=\"Scores\"/>\r\n        </Tabs>\r\n      </Paper>\r\n      <TabPanel value={value} index={0}>\r\n        <GenericEdit\r\n          vulnerabilityId={vulnerabilityId}\r\n          editMode={isEdit}\r\n        />\r\n        <ViewArrayField\r\n          vulnerabilityId={vulnerabilityId}\r\n          field={'evidence'}\r\n          label={'Evidences'}\r\n          editMode={isEdit}\r\n        />\r\n        <ViewArrayField\r\n          vulnerabilityId={vulnerabilityId}\r\n          field={'prevention'}\r\n          label={'Prevention methods'}\r\n          editMode={isEdit}\r\n        />\r\n      </TabPanel>\r\n      <TabPanel value={value} index={1}>\r\n        <ViewCvss\r\n          vulnerabilityId={vulnerabilityId}\r\n          label={'Prevention methods'}\r\n          editMode={isEdit}\r\n        />\r\n\r\n      </TabPanel>\r\n      <TabPanel value={value} index={2}>\r\n        <ViewScores\r\n          vulnerabilityId={vulnerabilityId}\r\n        />\r\n      </TabPanel>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\nexport default ViewVulnerability\r\n","import React from \"react\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport {Close} from \"@material-ui/icons\";\r\nimport Snackbar from \"@material-ui/core/Snackbar\";\r\nimport {SnackBarCtx} from \"../../context/SnackBarContext\";\r\n\r\n\r\nexport default function SnackBar(props) {\r\n  const { state, dispatch } = React.useContext(SnackBarCtx);\r\n\r\n\r\n\r\n  const closeSnackBar = (event, reason) => {\r\n    if (reason === 'clickaway') {\r\n      return;\r\n    }\r\n    dispatch({ type: \"CLOSE\", msg: '' })\r\n  };\r\n\r\n  return (\r\n    <Snackbar\r\n      anchorOrigin={{\r\n        vertical: 'bottom',\r\n        horizontal: 'center',\r\n      }}\r\n      open={state.open}\r\n      autoHideDuration={6000}\r\n      onClose={closeSnackBar}\r\n      message={state.msg}\r\n      action={\r\n        <React.Fragment>\r\n          <IconButton size=\"small\" aria-label=\"close\" color=\"inherit\" onClick={closeSnackBar}>\r\n            <Close fontSize=\"small\"/>\r\n          </IconButton>\r\n        </React.Fragment>\r\n      }\r\n    />\r\n  )\r\n}\r\n","import './App.css';\nimport React from 'react'\nimport {BrowserRouter, Route, Switch, Redirect} from 'react-router-dom';\n\nimport LoginPage from './pages/Login'\nimport CvssPage from './pages/Cvss'\nimport VulnerabilitiesPage from './pages/Vulnerabilities'\nimport MainNavigation from './components/navigation/MainNavigation'\nimport CreateVulnerability from \"./pages/CreateVulnerability\";\nimport ViewVulnerability from \"./components/view-vulnerability/ViewVulnerability\";\n\n// context\nimport  {LoginCtx} from './context/LoginContext'\nimport SnackBar from \"./components/support/SnackBar\";\n\n\n\nfunction App() {\n  const { authState} = React.useContext(LoginCtx);\n\n  return (\n    <BrowserRouter>\n      <React.Fragment>\n          <MainNavigation/>\n          <main className=\"main-content\">\n            <Switch>\n              {authState.token && <Redirect from=\"/\" to=\"/vulnerabilities\" exact/>}\n              {authState.token && <Redirect from=\"/login\" to=\"/vulnerabilities\" exact/>}\n              <Route path=\"/vulnerabilities\" component={VulnerabilitiesPage}/>\n              {authState.token && <Route path=\"/view/:id\" component={ViewVulnerability}/>}\n              {authState.token && <Route path=\"/create-vulnerability\" component={CreateVulnerability}/>}\n              {authState.token && <Route path=\"/cvss\" component={CvssPage}/>}\n              {!authState.token && <Route path=\"/login\" component={LoginPage}/>}\n              {!authState.token && <Route path=\"/login\" component={LoginPage}/>}\n              {!authState.token && <Redirect to=\"/login\" />}\n            </Switch>\n          </main>\n        <SnackBar />\n      </React.Fragment>\n    </BrowserRouter>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport {SnackBarCtxProvider} from \"./context/SnackBarContext\";\nimport {LoginCtxProvider} from \"./context/LoginContext\";\n\n\nReactDOM.render(\n  // <React.StrictMode>\n  <LoginCtxProvider>\n    <SnackBarCtxProvider>\n        <App/>\n    </SnackBarCtxProvider>\n  </LoginCtxProvider>,\n// </React.StrictMode>,\n  document.getElementById('root')\n)\n;\n\n"],"sourceRoot":""}