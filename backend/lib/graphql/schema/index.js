const {buildSchema} = require('graphql');
const {UserImportSchema} = require('./user')
const {VulnerabilityImportSchema} = require('./vulnerability')
const {CVSSImportSchema} = require('./commonVulnerabilityScoreSystem')
const {CvssScoresImportSchema} = require('./cvss-scores')

//

module.exports = buildSchema(`

  ${UserImportSchema}
  ${CVSSImportSchema}
  ${VulnerabilityImportSchema}
  ${CvssScoresImportSchema}
  
  type RootQuery {
    users: [User!]!
    vulnerabilities: [Vulnerability!]!
    getVulnerability(id: String!): Vulnerability!
    allCvss: [CommonVulnerabilityScoreSystem!]!
    login(username: String!, password: String!): AuthData! 
  }
  
  type RootMutation {
      createUser(userInput: UserInput): User
      createVulnerability(input: VulnerabilityNewInput): Vulnerability
      updateVulnerability(input: VulnerabilityUpdateInput): Vulnerability
      addArrayEntry(id: String!, fieldId: String!, values: [String!]!): Vulnerability
      updateCvss(id: String!, input: CVSSInput): Vulnerability
      deleteVulnerability(id: String!): [Vulnerability!]!
  }
  
  schema {
      query: RootQuery
      mutation: RootMutation
  }
`);
