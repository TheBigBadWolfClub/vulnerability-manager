

query getTypes {
    __type(name: "CVSSInput") {
        name
        inputFields{
            name
            type{
                kind
                name
                description
                enumValues{
                    name
                    description
                }
            }
        }
    }
}

query getSchema{
    __schema {
        types {
            name
            kind
            description
            fields{name  type{kind name}}
            enumValues {name description}
        }
    }
}

mutation  deleteVulnerability {
    deleteVulnerability(id:"5f9dcbd835c61d6d586fcc8d") {
        _id
    }
}

mutation {updateVulnerability(input: {id: "5f9ea896265ada7d00e5ce62", title: "new", description: "new", dueDate:"1604707200000", state: FIXED}) {_id}}


mutation updateGeneric {updateGenericData(id: "5f97709f1063e04ccc6c4526", title: "new title", description:"new desctiption") {_id title description}}

mutation newRef {addArrayEntry(id: "5f97709f1063e04ccc6c4526", fieldId:"evidence", values: ["asdfasd2", "asdfasf"]){evidence}}

query getVulne {
    getVulnerability(id: "5f97709f1063e04ccc6c4526") {_id}
}

query getVulnerabilities {
    vulnerabilities {
        _id
        cveId
        title
        cvss {
            _id
            attackVector
            attackComplexity
        }
        cvssScores {
            _id
            baseSeverity
            temporalSeverity
            environmentalSeverity
        }
    }
}


mutation addVuln {
    createVulnerability(vulnerabilityInput: {cveId:"cvid-2020-1", title: "a title", description:"a descriptio", attackVector:NETWORK, attackComplexity:LOW}) {
        _id
        cveId
        title
        description
        evidence
        prevention
        cvss {
            _id
            attackVector
            attackComplexity
            privilegesRequired
            userInteraction
            scope
            confidentialityImpact
            integrityImpact
            availabilityImpact
            exploitCodeMaturity
            remediationLevel
            reportConfidence
            confidentialityRequirement
            integrityRequirement
            availabilityRequirement
            modifiedAttackVector
            modifiedAttackComplexity
            modifiedPrivilegesRequired
            modifiedUserInteraction
            modifiedScope
            modifiedConfidentialityImpact
            modifiedIntegrityImpact
            modifiedAvailabilityImpact
        }
        cvssScores {
            _id
            baseScore
            baseSeverity
            baseISS
            baseImpact
            baseExploitability
            temporalScore
            temporalSeverity
            environmentalScore
            environmentalSeverity
            environmentalMISS
            environmentalModifiedImpact
            environmentalModifiedExploitability
        }
        createdAt
        updatedAt
    }
}







query loginAdmin {
    login(username:"admin", password: "admin") {userId, token, tokenExpiration, role}
}

query users {
   users {
    _id
    username
    role
  }
}

mutation addUserAdmin {
    createUser(userInput: {username: "admin", password: "admin", role: ADMINISTRATOR}) {_id username password role}

}

mutation addUserTester{
    createUser(userInput: {username: "tester", password: "tester", role: TESTER}) {_id username password role}
}

mutation addUserManager{
    createUser(userInput: {username: "manager", password: "maanger", role: SERVICE_MANAGER}) {_id username password role}
}

mutation addUserCorporate{
    createUser(userInput: {username: "corp", password: "corp", role: CORPORATE}) {_id username password role}
}
