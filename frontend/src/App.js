import './App.css';
import React from 'react'
import {BrowserRouter, Redirect, Route, Switch} from 'react-router-dom';

import LoginPage from './pages/Login'
import CvssPage from './pages/Cvss'
import VulnerabilitiesPage from './pages/Vulnerabilities'
import MainNavigation from './components/navigation/MainNavigation'
import CreateVulnerability from "./pages/CreateVulnerability";
import ViewVulnerability from "./components/view-vulnerability/ViewVulnerability";

// context
import {LoginCtx} from './context/LoginContext'
import SnackBar from "./components/support/SnackBar";


function App() {
    const {authState} = React.useContext(LoginCtx);

    return (
        <BrowserRouter>
            <React.Fragment>
                <MainNavigation/>
                <main className="main-content">
                    <Switch>
                        {authState.token && <Redirect from="/" to="/vulnerabilities" exact/>}
                        {authState.token && <Redirect from="/login" to="/vulnerabilities" exact/>}
                        <Route path="/vulnerabilities" component={VulnerabilitiesPage}/>
                        {authState.token && <Route path="/view/:id" component={ViewVulnerability}/>}
                        {authState.token && <Route path="/create-vulnerability" component={CreateVulnerability}/>}
                        {authState.token && <Route path="/cvss" component={CvssPage}/>}
                        {!authState.token && <Route path="/login" component={LoginPage}/>}
                        {!authState.token && <Route path="/login" component={LoginPage}/>}
                        {!authState.token && <Redirect to="/login"/>}
                    </Switch>
                </main>
                <SnackBar/>
            </React.Fragment>
        </BrowserRouter>
    );
}

export default App;
