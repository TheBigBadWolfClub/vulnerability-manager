import {cvssFields, cvssScoresFields} from './Cvss'


const tableQuery = {
  query: `
          query {
            vulnerabilities {
              _id
              cveId
              title
              cvss {
                attackVector
                attackComplexity
              }
              cvssScores {
                baseSeverity
                temporalSeverity
                environmentalSeverity
              }
            }
          }
      `
}

const chartState = {
  query: `
          query {
            vulnerabilities {
              state
              dueDate
              cvss {
                attackVector
                exploitCodeMaturity
              }
              cvssScores {
                baseScore
                baseSeverity
                temporalScore
                temporalSeverity
                environmentalScore
                environmentalSeverity
              }
            }
          }
      `
}

const createVulnerability = (cveId, title, description, state, dueDate) => {
  return {
    query: `
      mutation {
        createVulnerability(input: {
          cveId:"${cveId}", 
          title:"${title}", 
          description:"${description}", 
          state:${state}, 
          dueDate:"${dueDate}"}) {
            _id
         }
      }
    `
  }
}

const updateVulnerability = (data) => {
  return {
    query: `
     mutation {
     updateVulnerability(input: {
        id: "${data._id}",
        title: "${data.title}",
        description: "${data.description}",
        dueDate:"${data.dueDate}",
        state: ${data.state}}) {
          title
          description
          dueDate
          state
        }}
      `
  }
}

const getVulnerabilityFn = (id) => {
  return {
    query: `
     query {
      getVulnerability(id: "${id}") {
          _id
          cveId
          title
          description
          evidence
          prevention
          ${cvssFields}
          ${cvssScoresFields}
          createdAt
          updatedAt
        }
     }
  `
  }
}

const getSimplifiedVulnerability = (id, field) => {
  return {
    query: `
     query {
      getVulnerability(id: "${id}") {
          _id
          ${field}
        }
     }
  `
  }
}

const deleteVulnerability = (id) => {
  return {
    query: `
     mutation {
       deleteVulnerability(id:"${id}") {
          _id
          cveId
          title
          cvss {
            attackVector
            attackComplexity
          }
          cvssScores {
            baseSeverity
            temporalSeverity
            environmentalSeverity
          }
       }
     }
  `
  }
}

export {
  tableQuery,
  getVulnerabilityFn,
  getSimplifiedVulnerability,
  deleteVulnerability,
  createVulnerability,
  updateVulnerability,
  chartState
}
