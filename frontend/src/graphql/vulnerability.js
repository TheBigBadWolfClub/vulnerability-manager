import {cvssFields, cvssScoresFields} from './Cvss'


const tableQuery = {
  query: `
          query {
            vulnerabilities {
              _id
              cveId
              title
              cvss {
                attackVector
                attackComplexity
              }
              cvssScores {
                baseSeverity
                temporalSeverity
                environmentalSeverity
              }
            }
          }
      `

}



const getVulnerabilityFn = (id) => {
  return {
    query: `
     query {
      getVulnerability(id: "${id}") {
          _id
          cveId
          title
          description
          evidence
          prevention
          ${cvssFields}
          ${cvssScoresFields}
          createdAt
          updatedAt
        }
     }
  `
  }
}

const getSimplifiedVulnerability = (id, field) => {
  return {
    query: `
     query {
      getVulnerability(id: "${id}") {
          _id
          ${field}
        }
     }
  `
  }
}

export {tableQuery, getVulnerabilityFn, getSimplifiedVulnerability}
