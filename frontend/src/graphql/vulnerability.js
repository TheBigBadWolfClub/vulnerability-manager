const tableQuery =
  {
    query: `
          query {
            vulnerabilities {
              _id
              cveId
              title
              cvss {
                attackVector
                attackComplexity
              }
              cvssScores {
                baseSeverity
                temporalSeverity
                environmentalSeverity
              }
            }
          }
      `

  }
const getArrayEntries = (id, field) => {
  return {
    query: `
     query {
      getVulnerability(id: "${id}") {
          _id
          ${field}
        }
     }
  `
  }
}

const getVulnerabilityFn = (id) => {
  return {
    query: `
     query {
      getVulnerability(id: "${id}") {
          _id
          cveId
          title
          description
          evidence
          prevention
          cvss {
            _id
            attackVector
            attackComplexity
            privilegesRequired
            userInteraction
            scope
            confidentialityImpact
            integrityImpact
            availabilityImpact
            exploitCodeMaturity
            remediationLevel
            reportConfidence
            confidentialityRequirement
            integrityRequirement
            availabilityRequirement
            modifiedAttackVector
            modifiedAttackComplexity
            modifiedPrivilegesRequired
            modifiedUserInteraction
            modifiedScope
            modifiedConfidentialityImpact
            modifiedIntegrityImpact
            modifiedAvailabilityImpact
          }
          cvssScores {
            _id
            baseScore
            baseSeverity
            baseISS
            baseImpact
            baseExploitability
            temporalScore
            temporalSeverity
            environmentalScore
            environmentalSeverity
            environmentalMISS
            environmentalModifiedImpact
            environmentalModifiedExploitability
          }
          createdAt
          updatedAt
        }
     }
  `
  }
}

module.exports = {tableQuery, getVulnerabilityFn, getArrayEntries}
