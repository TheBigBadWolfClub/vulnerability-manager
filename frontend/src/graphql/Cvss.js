const cvssFields = `cvss {
      _id
      attackVector
      attackComplexity
      privilegesRequired
      userInteraction
      scope
      confidentialityImpact
      integrityImpact
      availabilityImpact
      exploitCodeMaturity
      remediationLevel
      reportConfidence
      confidentialityRequirement
      integrityRequirement
      availabilityRequirement
      modifiedAttackVector
      modifiedAttackComplexity
      modifiedPrivilegesRequired
      modifiedUserInteraction
      modifiedScope
      modifiedConfidentialityImpact
      modifiedIntegrityImpact
      modifiedAvailabilityImpact
    }`


const cvssScoresFields = `cvssScores {
            _id
            baseScore
            baseSeverity
            baseISS
            baseImpact
            baseExploitability
            temporalScore
            temporalSeverity
            environmentalScore
            environmentalSeverity
            environmentalMISS
            environmentalModifiedImpact
            environmentalModifiedExploitability
          }
  `

const queryTypes = {
    query: `
     query getTypes {
        __type(name: "CVSSInput") {
          name
          inputFields{
            name 
            type{
              kind
              name
              description
              enumValues{
                name 
                description
              }
            }
          }
        }
     }
  `
}

const mutationQuery = (id, data) => {
    return {
        query: `
      mutation {
        updateCvss(id: "${id}", input: ${data}) {
          ${cvssFields}
          ${cvssScoresFields}
        }
      }
      `
    }
}


export {queryTypes, cvssFields, cvssScoresFields, mutationQuery}
