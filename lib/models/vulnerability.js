const mongoose = require('mongoose');
const CVSS = require('./commonVulnerabilityScoreSystem');

const VulnerabilitySchema = mongoose.Schema({
  cveId: {
    type: String,
    require: true,
    unique: true
  },
  title: {
    type: String,
    require: true
  },
  description: {
    type: String,
    require: true
  },
  evidence: [
    {type: String}
  ],
  prevention: [
    {type: String}
  ],
  baseScore: {
    type: Number,
    require: true
  },
  temporalScore: {
    type: Number,
    require: true
  },
  environmentScore: {
    type: Number,
    require: true
  },
  score: {
    type: CVSS,
    require: true
  },
})

module.exports = mongoose.model('Vulnerability', VulnerabilitySchema);
